# 概况
加电后执行bois程序，bois程序加载第一个启动盘的第一扇区512字节的启动程序到内存0x07c00处。

# bois 启动

cpu加电后把cs值为0xF000,ip值为0xFFF0，即cs:ip就指向了0xFFFF0这个内存位置，bios从这里开始执行。bios在内存中加载中断向量表和中断服务程序。

bios在内存开头的1kb空间(0x00000 ~ 0x003FF)构建中断向量表(Interrupt Vector Table)，把其后的256字节(0x00400 ~ 0x004FF)作为bios数据区，在大约57kb后的位置(0x0E05B)加载8kb左右的中断服务程序(Interrupt Service)。
为什么中断向量表是1kb大小？共256个中断，每个中断4字节，前两字节为cs值,后两字节为ip值。共256*4=1024=1kb

bios自检并加载中断服务程序后会触发0x19中断，cpu通过中断向量表查找到中断服务程序并执行，此程序会把第一个启动盘的第一扇区512字节加载到内存0x07c00处并把执行权交给此处的代码

第一扇区最后两字节为0x55AA的盘为启动盘

# bootsect 启动扇区

bootsect把自身从0x07c00处复制到0x90000处，并在其后的0x90200处加载4扇区(512*4)的setup程序。接着加载240扇区(约120kb)的kernel到0x10000处。执行完这些后跳转到0x90200处执行setup

# setup
setup程利用bios中断服务从设备上提取设备数据，如光标位置，显示页面等。通过0x41和0x46中断获取硬盘参数并存放到0x9000:0x0080和0x9000:0x0090处。最终收集的设备信息存放在0x90000~0x901FC中

- 关中断
- 将0x10000处的内核代码复制到0x00000
- 构建全局描述符表GDT(global descriptor table)中断描述符表IDT(interrupt descriptor table)
- 打开A20
- 对中断控制器8259A编程
# kernel
